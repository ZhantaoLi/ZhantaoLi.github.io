<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquid Glass Periodic Table (1-118)</title>
    <style>
        :root {
            --bg-color: #000000;
            --text-color: #ffffff;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --card-hover: rgba(255, 255, 255, 0.15);
            --glass-blur: blur(12px);
            --highlight: rgba(255, 255, 255, 0.4);
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            --modal-bg: rgba(20, 20, 20, 0.7);
            --accent-alkali: #ff6b6b;
            --accent-alkaline: #feca57;
            --accent-transition: #48dbfb;
            --accent-basic: #1dd1a1;
            --accent-noble: #a29bfe;
            --accent-rare: #ff9ff3;
        }

        [data-theme="light"] {
            --bg-color: #f0f2f5;
            --text-color: #333333;
            --card-bg: rgba(255, 255, 255, 0.3);
            --card-border: rgba(255, 255, 255, 0.6);
            --card-hover: rgba(255, 255, 255, 0.5);
            --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            --modal-bg: rgba(255, 255, 255, 0.6);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; transition: background 0.3s, color 0.3s; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        /* 动态液态背景 */
        .liquid-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.6;
            animation: float 10s infinite ease-in-out alternate;
        }
        .orb-1 { width: 50vw; height: 50vw; background: #4facfe; top: -10%; left: -10%; animation-duration: 15s; }
        .orb-2 { width: 40vw; height: 40vw; background: #00f2fe; bottom: -10%; right: -10%; animation-duration: 12s; }
        .orb-3 { width: 30vw; height: 30vw; background: #ff0080; top: 40%; left: 40%; animation-duration: 18s; }

        @keyframes float {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        /* 控制栏 */
        .controls {
            padding: 20px;
            display: flex;
            gap: 20px;
            z-index: 10;
        }
        button {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            color: var(--text-color);
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            backdrop-filter: var(--glass-blur);
            font-weight: bold;
        }
        button:hover { background: var(--card-hover); transform: scale(1.05); }

        /* 周期表网格 */
        .table-container {
            display: grid;
            grid-template-columns: repeat(18, minmax(3.5vw, 60px));
            grid-template-rows: repeat(10, minmax(3.5vw, 60px));
            gap: 6px;
            padding: 20px;
            max-width: 1400px;
            margin-bottom: 50px;
        }

        /* 元素卡片 */
        .element {
            position: relative;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 8px;
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), box-shadow 0.3s;
            overflow: hidden;
        }

        .element:hover {
            transform: translateY(-5px) scale(1.1);
            background: var(--card-hover);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            z-index: 5;
            border-color: var(--highlight);
        }

        .at-num { font-size: 0.7em; position: absolute; top: 4px; left: 6px; opacity: 0.7; }
        .symbol { font-size: 1.4em; font-weight: 800; background: linear-gradient(135deg, var(--text-color), #888); -webkit-background-clip: text; color: transparent; }
        .name { font-size: 0.6em; margin-top: 2px; text-align: center; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 90%; }
        
        /* 颜色分类指示条 */
        .indicator { position: absolute; bottom: 0; left: 0; width: 100%; height: 3px; opacity: 0.8; }

        /* 弹窗详情 */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
            z-index: 100;
        }
        .modal-overlay.active { opacity: 1; pointer-events: all; }
        
        .modal {
            background: var(--modal-bg);
            width: 90%; max-width: 500px;
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--card-border);
            box-shadow: var(--shadow);
            transform: scale(0.8); transition: transform 0.3s;
            position: relative;
            color: var(--text-color);
        }
        .modal-overlay.active .modal { transform: scale(1); }
        .modal-close { position: absolute; top: 15px; right: 20px; cursor: pointer; font-size: 1.5em; }
        
        .modal-header { display: flex; align-items: center; margin-bottom: 20px; }
        .modal-symbol { font-size: 4em; font-weight: 900; margin-right: 20px; }
        .modal-info h2 { font-size: 2em; margin-bottom: 5px; }
        .modal-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .data-point { background: rgba(0,0,0,0.1); padding: 10px; border-radius: 10px; }
        [data-theme="light"] .data-point { background: rgba(255,255,255,0.4); }
        .label { font-size: 0.8em; opacity: 0.7; display: block; }
        .value { font-size: 1.1em; font-weight: 600; }
        .desc-box { margin-top: 20px; line-height: 1.6; font-size: 0.95em; opacity: 0.9; }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .table-container { grid-template-columns: repeat(18, minmax(18px, 1fr)); gap: 2px; padding: 5px; }
            .symbol { font-size: 0.8em; }
            .at-num, .name { display: none; } /* 手机端隐藏小字 */
            .element:active { transform: scale(1.5); z-index: 10; }
        }
    </style>
</head>
<body>

    <div class="liquid-bg">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>

    <div class="controls">
        <button id="langBtn" onclick="toggleLang()">中 / EN</button>
        <button id="themeBtn" onclick="toggleTheme()">Light / Dark</button>
    </div>

    <h1 id="mainTitle" style="margin-bottom: 10px; text-shadow: 0 4px 10px rgba(0,0,0,0.3);">元素周期表</h1>

    <div class="table-container" id="periodicTable">
        </div>

    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal" id="elementModal">
            <span class="modal-close" onclick="closeModal(null, true)">×</span>
            <div class="modal-header">
                <div class="modal-symbol" id="mSymbol">H</div>
                <div class="modal-info">
                    <h2 id="mName">Hydrogen</h2>
                    <span id="mCategory" style="padding: 4px 8px; border-radius: 4px; background: rgba(100,100,100,0.3); font-size: 0.8em;">Non-metal</span>
                </div>
            </div>
            <div class="desc-box" id="mDesc">
                Description here...
            </div>
            <div class="modal-grid">
                <div class="data-point"><span class="label">Atomic Number</span><span class="value" id="mNum">1</span></div>
                <div class="data-point"><span class="label">Atomic Mass</span><span class="value" id="mMass">1.008</span></div>
                <div class="data-point"><span class="label">Period</span><span class="value" id="mPeriod">1</span></div>
                <div class="data-point"><span class="label">Group</span><span class="value" id="mGroup">1</span></div>
                <div class="data-point"><span class="label">Electron Config</span><span class="value" id="mConfig">1s1</span></div>
            </div>
        </div>
    </div>

<script>
    // 全局状态
    let currentLang = 'zh'; // 'zh' or 'en'
    let currentTheme = 'dark'; // 'dark' or 'light'

    // 完整的1-118号元素数据
    // 格式: [原子序数, 符号, 英文名, 中文名, 质量, 周期, 族, 类别代码, 电子排布简化]
    // 类别代码: 1=碱金属, 2=碱土金属, 3=过渡金属, 4=主族金属, 5=类金属, 6=非金属, 7=卤素, 8=稀有气体, 9=镧系, 10=锕系
    const rawData = [
        [1,"H","Hydrogen","氢","1.008",1,1,6,"1s1"],
        [2,"He","Helium","氦","4.0026",1,18,8,"1s2"],
        [3,"Li","Lithium","锂","6.94",2,1,1,"[He] 2s1"],
        [4,"Be","Beryllium","铍","9.0122",2,2,2,"[He] 2s2"],
        [5,"B","Boron","硼","10.81",2,13,5,"[He] 2s2 2p1"],
        [6,"C","Carbon","碳","12.011",2,14,6,"[He] 2s2 2p2"],
        [7,"N","Nitrogen","氮","14.007",2,15,6,"[He] 2s2 2p3"],
        [8,"O","Oxygen","氧","15.999",2,16,6,"[He] 2s2 2p4"],
        [9,"F","Fluorine","氟","18.998",2,17,7,"[He] 2s2 2p5"],
        [10,"Ne","Neon","氖","20.180",2,18,8,"[He] 2s2 2p6"],
        [11,"Na","Sodium","钠","22.990",3,1,1,"[Ne] 3s1"],
        [12,"Mg","Magnesium","镁","24.305",3,2,2,"[Ne] 3s2"],
        [13,"Al","Aluminium","铝","26.982",3,13,4,"[Ne] 3s2 3p1"],
        [14,"Si","Silicon","硅","28.085",3,14,5,"[Ne] 3s2 3p2"],
        [15,"P","Phosphorus","磷","30.974",3,15,6,"[Ne] 3s2 3p3"],
        [16,"S","Sulfur","硫","32.06",3,16,6,"[Ne] 3s2 3p4"],
        [17,"Cl","Chlorine","氯","35.45",3,17,7,"[Ne] 3s2 3p5"],
        [18,"Ar","Argon","氩","39.948",3,18,8,"[Ne] 3s2 3p6"],
        [19,"K","Potassium","钾","39.098",4,1,1,"[Ar] 4s1"],
        [20,"Ca","Calcium","钙","40.078",4,2,2,"[Ar] 4s2"],
        [21,"Sc","Scandium","钪","44.956",4,3,3,"[Ar] 3d1 4s2"],
        [22,"Ti","Titanium","钛","47.867",4,4,3,"[Ar] 3d2 4s2"],
        [23,"V","Vanadium","钒","50.942",4,5,3,"[Ar] 3d3 4s2"],
        [24,"Cr","Chromium","铬","51.996",4,6,3,"[Ar] 3d5 4s1"],
        [25,"Mn","Manganese","锰","54.938",4,7,3,"[Ar] 3d5 4s2"],
        [26,"Fe","Iron","铁","55.845",4,8,3,"[Ar] 3d6 4s2"],
        [27,"Co","Cobalt","钴","58.933",4,9,3,"[Ar] 3d7 4s2"],
        [28,"Ni","Nickel","镍","58.693",4,10,3,"[Ar] 3d8 4s2"],
        [29,"Cu","Copper","铜","63.546",4,11,3,"[Ar] 3d10 4s1"],
        [30,"Zn","Zinc","锌","65.38",4,12,3,"[Ar] 3d10 4s2"],
        [31,"Ga","Gallium","镓","69.723",4,13,4,"[Ar] 3d10 4s2 4p1"],
        [32,"Ge","Germanium","锗","72.630",4,14,5,"[Ar] 3d10 4s2 4p2"],
        [33,"As","Arsenic","砷","74.922",4,15,5,"[Ar] 3d10 4s2 4p3"],
        [34,"Se","Selenium","硒","78.971",4,16,6,"[Ar] 3d10 4s2 4p4"],
        [35,"Br","Bromine","溴","79.904",4,17,7,"[Ar] 3d10 4s2 4p5"],
        [36,"Kr","Krypton","氪","83.798",4,18,8,"[Ar] 3d10 4s2 4p6"],
        [37,"Rb","Rubidium","铷","85.468",5,1,1,"[Kr] 5s1"],
        [38,"Sr","Strontium","锶","87.62",5,2,2,"[Kr] 5s2"],
        [39,"Y","Yttrium","钇","88.906",5,3,3,"[Kr] 4d1 5s2"],
        [40,"Zr","Zirconium","锆","91.224",5,4,3,"[Kr] 4d2 5s2"],
        [41,"Nb","Niobium","铌","92.906",5,5,3,"[Kr] 4d4 5s1"],
        [42,"Mo","Molybdenum","钼","95.95",5,6,3,"[Kr] 4d5 5s1"],
        [43,"Tc","Technetium","锝","(98)",5,7,3,"[Kr] 4d5 5s2"],
        [44,"Ru","Ruthenium","钌","101.07",5,8,3,"[Kr] 4d7 5s1"],
        [45,"Rh","Rhodium","铑","102.91",5,9,3,"[Kr] 4d8 5s1"],
        [46,"Pd","Palladium","钯","106.42",5,10,3,"[Kr] 4d10"],
        [47,"Ag","Silver","银","107.87",5,11,3,"[Kr] 4d10 5s1"],
        [48,"Cd","Cadmium","镉","112.41",5,12,3,"[Kr] 4d10 5s2"],
        [49,"In","Indium","铟","114.82",5,13,4,"[Kr] 4d10 5s2 5p1"],
        [50,"Sn","Tin","锡","118.71",5,14,4,"[Kr] 4d10 5s2 5p2"],
        [51,"Sb","Antimony","锑","121.76",5,15,5,"[Kr] 4d10 5s2 5p3"],
        [52,"Te","Tellurium","碲","127.60",5,16,5,"[Kr] 4d10 5s2 5p4"],
        [53,"I","Iodine","碘","126.90",5,17,7,"[Kr] 4d10 5s2 5p5"],
        [54,"Xe","Xenon","氙","131.29",5,18,8,"[Kr] 4d10 5s2 5p6"],
        [55,"Cs","Caesium","铯","132.91",6,1,1,"[Xe] 6s1"],
        [56,"Ba","Barium","钡","137.33",6,2,2,"[Xe] 6s2"],
        [57,"La","Lanthanum","镧","138.91",6,3,9,"[Xe] 5d1 6s2"],
        [58,"Ce","Cerium","铈","140.12",6,101,9,"[Xe] 4f1 5d1 6s2"],
        [59,"Pr","Praseodymium","镨","140.91",6,102,9,"[Xe] 4f3 6s2"],
        [60,"Nd","Neodymium","钕","144.24",6,103,9,"[Xe] 4f4 6s2"],
        [61,"Pm","Promethium","钷","(145)",6,104,9,"[Xe] 4f5 6s2"],
        [62,"Sm","Samarium","钐","150.36",6,105,9,"[Xe] 4f6 6s2"],
        [63,"Eu","Europium","铕","151.96",6,106,9,"[Xe] 4f7 6s2"],
        [64,"Gd","Gadolinium","钆","157.25",6,107,9,"[Xe] 4f7 5d1 6s2"],
        [65,"Tb","Terbium","铽","158.93",6,108,9,"[Xe] 4f9 6s2"],
        [66,"Dy","Dysprosium","镝","162.50",6,109,9,"[Xe] 4f10 6s2"],
        [67,"Ho","Holmium","钬","164.93",6,110,9,"[Xe] 4f11 6s2"],
        [68,"Er","Erbium","铒","167.26",6,111,9,"[Xe] 4f12 6s2"],
        [69,"Tm","Thulium","铥","168.93",6,112,9,"[Xe] 4f13 6s2"],
        [70,"Yb","Ytterbium","镱","173.05",6,113,9,"[Xe] 4f14 6s2"],
        [71,"Lu","Lutetium","镥","174.97",6,114,9,"[Xe] 4f14 5d1 6s2"],
        [72,"Hf","Hafnium","铪","178.49",6,4,3,"[Xe] 4f14 5d2 6s2"],
        [73,"Ta","Tantalum","钽","180.95",6,5,3,"[Xe] 4f14 5d3 6s2"],
        [74,"W","Tungsten","钨","183.84",6,6,3,"[Xe] 4f14 5d4 6s2"],
        [75,"Re","Rhenium","铼","186.21",6,7,3,"[Xe] 4f14 5d5 6s2"],
        [76,"Os","Osmium","锇","190.23",6,8,3,"[Xe] 4f14 5d6 6s2"],
        [77,"Ir","Iridium","铱","192.22",6,9,3,"[Xe] 4f14 5d7 6s2"],
        [78,"Pt","Platinum","铂","195.08",6,10,3,"[Xe] 4f14 5d9 6s1"],
        [79,"Au","Gold","金","196.97",6,11,3,"[Xe] 4f14 5d10 6s1"],
        [80,"Hg","Mercury","汞","200.59",6,12,3,"[Xe] 4f14 5d10 6s2"],
        [81,"Tl","Thallium","铊","204.38",6,13,4,"[Xe] 4f14 5d10 6s2 6p1"],
        [82,"Pb","Lead","铅","207.2",6,14,4,"[Xe] 4f14 5d10 6s2 6p2"],
        [83,"Bi","Bismuth","铋","208.98",6,15,4,"[Xe] 4f14 5d10 6s2 6p3"],
        [84,"Po","Polonium","钋","(209)",6,16,5,"[Xe] 4f14 5d10 6s2 6p4"],
        [85,"At","Astatine","砹","(210)",6,17,7,"[Xe] 4f14 5d10 6s2 6p5"],
        [86,"Rn","Radon","氡","(222)",6,18,8,"[Xe] 4f14 5d10 6s2 6p6"],
        [87,"Fr","Francium","钫","(223)",7,1,1,"[Rn] 7s1"],
        [88,"Ra","Radium","镭","(226)",7,2,2,"[Rn] 7s2"],
        [89,"Ac","Actinium","锕","(227)",7,3,10,"[Rn] 6d1 7s2"],
        [90,"Th","Thorium","钍","232.04",7,101,10,"[Rn] 6d2 7s2"],
        [91,"Pa","Protactinium","镤","231.04",7,102,10,"[Rn] 5f2 6d1 7s2"],
        [92,"U","Uranium","铀","238.03",7,103,10,"[Rn] 5f3 6d1 7s2"],
        [93,"Np","Neptunium","镎","(237)",7,104,10,"[Rn] 5f4 6d1 7s2"],
        [94,"Pu","Plutonium","钚","(244)",7,105,10,"[Rn] 5f6 7s2"],
        [95,"Am","Americium","镅","(243)",7,106,10,"[Rn] 5f7 7s2"],
        [96,"Cm","Curium","锔","(247)",7,107,10,"[Rn] 5f7 6d1 7s2"],
        [97,"Bk","Berkelium","锫","(247)",7,108,10,"[Rn] 5f9 7s2"],
        [98,"Cf","Californium","锎","(251)",7,109,10,"[Rn] 5f10 7s2"],
        [99,"Es","Einsteinium","锿","(252)",7,110,10,"[Rn] 5f11 7s2"],
        [100,"Fm","Fermium","镄","(257)",7,111,10,"[Rn] 5f12 7s2"],
        [101,"Md","Mendelevium","钔","(258)",7,112,10,"[Rn] 5f13 7s2"],
        [102,"No","Nobelium","锘","(259)",7,113,10,"[Rn] 5f14 7s2"],
        [103,"Lr","Lawrencium","铹","(266)",7,114,10,"[Rn] 5f14 7p1"],
        [104,"Rf","Rutherfordium","𬬻","(267)",7,4,3,"[Rn] 5f14 6d2 7s2"],
        [105,"Db","Dubnium","𬭊","(268)",7,5,3,"[Rn] 5f14 6d3 7s2"],
        [106,"Sg","Seaborgium","𬭳","(269)",7,6,3,"[Rn] 5f14 6d4 7s2"],
        [107,"Bh","Bohrium","𬭛","(270)",7,7,3,"[Rn] 5f14 6d5 7s2"],
        [108,"Hs","Hassium","𬭶","(269)",7,8,3,"[Rn] 5f14 6d6 7s2"],
        [109,"Mt","Meitnerium","鿏","(278)",7,9,3,"[Rn] 5f14 6d7 7s2"], // 修正名字
        [110,"Ds","Darmstadtium","𫟼","(281)",7,10,3,"[Rn] 5f14 6d8 7s2"],
        [111,"Rg","Roentgenium","𬬭","(282)",7,11,3,"[Rn] 5f14 6d9 7s2"],
        [112,"Cn","Copernicium","鿔","(285)",7,12,3,"[Rn] 5f14 6d10 7s2"],
        [113,"Nh","Nihonium","鿭","(286)",7,13,4,"[Rn] 5f14 6d10 7s2 7p1"],
        [114,"Fl","Flerovium","𫓧","(289)",7,14,4,"[Rn] 5f14 6d10 7s2 7p2"],
        [115,"Mc","Moscovium","镆","(290)",7,15,4,"[Rn] 5f14 6d10 7s2 7p3"],
        [116,"Lv","Livermorium","𫟷","(293)",7,16,4,"[Rn] 5f14 6d10 7s2 7p4"],
        [117,"Ts","Tennessine","鿬","(294)",7,17,7,"[Rn] 5f14 6d10 7s2 7p5"],
        [118,"Og","Oganesson","鿫","(294)",7,18,8,"[Rn] 5f14 6d10 7s2 7p6"]
    ];
    
    // 类别映射颜色
    const catColors = {
        1: "var(--accent-alkali)",
        2: "var(--accent-alkaline)",
        3: "var(--accent-transition)",
        4: "var(--accent-basic)",
        5: "#74b9ff",
        6: "#0984e3",
        7: "#a29bfe",
        8: "var(--accent-noble)",
        9: "var(--accent-rare)",
        10: "#fab1a0"
    };

    const catNames = {
        en: {1:"Alkali Metal", 2:"Alkaline Earth", 3:"Transition Metal", 4:"Post-transition", 5:"Metalloid", 6:"Reactive Non-metal", 7:"Halogen", 8:"Noble Gas", 9:"Lanthanide", 10:"Actinide"},
        zh: {1:"碱金属", 2:"碱土金属", 3:"过渡金属", 4:"贫金属", 5:"类金属", 6:"非金属", 7:"卤素", 8:"稀有气体", 9:"镧系元素", 10:"锕系元素"}
    };

    const elementData = rawData.map(e => ({
        num: e[0], symbol: e[1], nameEn: e[2], nameCn: e[3], mass: e[4],
        period: e[5], group: e[6], cat: e[7], config: e[8]
    }));

    function initTable() {
        const container = document.getElementById('periodicTable');
        container.innerHTML = '';

        elementData.forEach(el => {
            const div = document.createElement('div');
            div.className = 'element';
            
            // 计算Grid位置
            // 镧系 (57-71) -> row 9 (offset in grid visually)
            // 锕系 (89-103) -> row 10
            let gridCol = el.group;
            let gridRow = el.period;

            // 特殊处理 镧系和锕系
            if (el.num >= 57 && el.num <= 71) {
                gridRow = 9; // 放在下方第一行
                gridCol = el.num - 57 + 4; // 偏移
                // 57号镧本身其实在主表里也有位置，但为了美观通常全拉下来，
                // 或者主表留一个空位。这里采用 Apple 风格：分离显示。
                // 修正：主表位置 6,3 留给 57-71 占位符，这里我们直接把它们放到下面
            } else if (el.num >= 89 && el.num <= 103) {
                gridRow = 10; // 放在下方第二行
                gridCol = el.num - 89 + 4;
            } else {
                // 标准位置
            }
            
            // 为了让下方两行空开一点，给Row 8留白（CSS grid gap handles it naturally if rows match）
            // 实际上CSS Grid 1-7行是主表。镧系锕系设为 row 9, 10。Row 8 作为间隔。
            if(gridRow >= 9) {
                // 镧系锕系
            } else {
                // 正常元素
            }

            div.style.gridColumn = gridCol;
            div.style.gridRow = gridRow;

            // 颜色条
            const color = catColors[el.cat] || "#fff";
            
            div.innerHTML = `
                <span class="at-num">${el.num}</span>
                <span class="symbol">${el.symbol}</span>
                <span class="name">${currentLang === 'zh' ? el.nameCn : el.nameEn}</span>
                <div class="indicator" style="background:${color}"></div>
            `;

            div.onclick = () => showDetails(el);
            container.appendChild(div);
        });

        // 添加 57-71 和 89-103 的占位符到主表 (Row 6 Col 3, Row 7 Col 3)
        // 可选，为了视觉完整性
        addPlaceholder(6, 3, "57-71", "La-Lu");
        addPlaceholder(7, 3, "89-103", "Ac-Lr");
    }

    function addPlaceholder(row, col, range, text) {
        const container = document.getElementById('periodicTable');
        const div = document.createElement('div');
        div.className = 'element';
        div.style.gridColumn = col;
        div.style.gridRow = row;
        div.style.opacity = '0.5';
        div.style.pointerEvents = 'none'; // 不可点
        div.innerHTML = `<span class="symbol" style="font-size:1em">${text}</span><span class="name">${range}</span>`;
        container.appendChild(div);
    }

    function showDetails(el) {
        const modal = document.getElementById('modalOverlay');
        const mSymbol = document.getElementById('mSymbol');
        const mName = document.getElementById('mName');
        const mCategory = document.getElementById('mCategory');
        const mDesc = document.getElementById('mDesc');
        const mNum = document.getElementById('mNum');
        const mMass = document.getElementById('mMass');
        const mPeriod = document.getElementById('mPeriod');
        const mGroup = document.getElementById('mGroup');
        const mConfig = document.getElementById('mConfig');

        // 设置颜色
        const color = catColors[el.cat];
        mSymbol.style.color = color;
        mSymbol.innerText = el.symbol;

        // 根据语言
        if (currentLang === 'zh') {
            mName.innerText = `${el.nameCn} (${el.nameEn})`;
            mCategory.innerText = catNames.zh[el.cat];
            mDesc.innerText = generateDescZh(el);
        } else {
            mName.innerText = `${el.nameEn}`;
            mCategory.innerText = catNames.en[el.cat];
            mDesc.innerText = generateDescEn(el);
        }
        
        mCategory.style.border = `1px solid ${color}`;
        mCategory.style.color = color;

        mNum.innerText = el.num;
        mMass.innerText = el.mass;
        mPeriod.innerText = el.period;
        
        // 处理特殊族的显示
        if(el.num >= 57 && el.num <= 71) mGroup.innerText = "Lanthanides";
        else if(el.num >= 89 && el.num <= 103) mGroup.innerText = "Actinides";
        else mGroup.innerText = el.group;

        mConfig.innerText = el.config;

        modal.classList.add('active');
    }

    function closeModal(e, force) {
        if (force || e.target.id === 'modalOverlay') {
            document.getElementById('modalOverlay').classList.remove('active');
        }
    }

    function toggleLang() {
        currentLang = currentLang === 'zh' ? 'en' : 'zh';
        document.getElementById('mainTitle').innerText = currentLang === 'zh' ? '元素周期表' : 'Periodic Table';
        initTable(); // 重新渲染名字
    }

    function toggleTheme() {
        const body = document.body;
        if (currentTheme === 'dark') {
            body.setAttribute('data-theme', 'light');
            currentTheme = 'light';
        } else {
            body.removeAttribute('data-theme');
            currentTheme = 'dark';
        }
    }

    // 简单的描述生成器（因为硬编码118个描述太长了）
    function generateDescZh(el) {
        return `${el.nameCn}（${el.nameEn}）是第${el.num}号元素。它位于第${el.period}周期，属于${catNames.zh[el.cat]}。相对原子质量约为${el.mass}。${el.config}是其电子排布。在化学中，它具有重要的研究和应用价值。`;
    }

    function generateDescEn(el) {
        return `${el.nameEn} (Symbol: ${el.symbol}) is the chemical element with atomic number ${el.num}. It is a ${catNames.en[el.cat].toLowerCase()} in period ${el.period}. Its atomic mass is approximately ${el.mass}. Electron configuration: ${el.config}.`;
    }

    // 初始化
    initTable();

    // 3D Tilt Effect on Modal (Apple style detail)
    const modal = document.querySelector('.modal');
    document.addEventListener('mousemove', (e) => {
        if (!document.getElementById('modalOverlay').classList.contains('active')) return;
        const x = (window.innerWidth / 2 - e.pageX) / 25;
        const y = (window.innerHeight / 2 - e.pageY) / 25;
        modal.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
    });

</script>
</body>
</html>