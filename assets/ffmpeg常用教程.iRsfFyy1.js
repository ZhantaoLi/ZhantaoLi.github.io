import{_ as g}from"./ValaxyMain.vue_vue_type_style_index_0_lang.BRzNY7yM.js";import"./chunks/@vueuse/motion.D1jGozFR.js";import{e as o,u as E,a as u}from"./chunks/vue-router.BySQwpdS.js";import{aa as y,al as l,ad as t,ae as s,ai as i,ah as m,O as b,ab as f,a1 as F}from"./framework.DR8s0htE.js";import"./app.DIkRhtth.js";import"./chunks/dayjs.BdcnXKr1.js";import"./chunks/vue-i18n.DoGyTGZU.js";import"./chunks/pinia.CUhcc_VX.js";/* empty css                    */import"./chunks/nprogress.B6x19dEb.js";import"./YunComment.vue_vue_type_style_index_0_lang.CCia-43r.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.DFOi-bX3.js";import"./post.D7I_uheP.js";const v=o("/posts/ffmpeg常用教程",async e=>JSON.parse('{"title":"ffmpeg常用教程","description":"","frontmatter":{"title":"ffmpeg常用教程","tags":["ffmpeg"],"categories":"ffmpeg","date":"2024-06-01","updated":"2025-08-05"},"headers":[],"relativePath":"pages/posts/ffmpeg常用教程.md","lastUpdated":1758969156000}'),{lazy:(e,n)=>e.name===n.name}),U={__name:"ffmpeg常用教程",setup(e,{expose:n}){const{data:p}=v(),r=u(),c=E(),h=Object.assign(c.meta.frontmatter||{},p.value?.frontmatter||{});return r.currentRoute.value.data=p.value,F("valaxy:frontmatter",h),globalThis.$frontmatter=h,n({frontmatter:{title:"ffmpeg常用教程",tags:["ffmpeg"],categories:"ffmpeg",date:"2024-06-01",updated:"2025-08-05"}}),(a,k)=>{const d=g;return f(),y(d,{frontmatter:b(h)},{"main-content-md":l(()=>[...k[0]||(k[0]=[s("h2",{id:"一、安装",tabindex:"-1"},[i("一、安装 "),s("a",{class:"header-anchor",href:"#一、安装","aria-label":'Permalink to "一、安装"'},"​")],-1),s("p",null,[s("strong",null,[i("ffmpeg官网："),s("a",{href:"https://www.ffmpeg.org/download.html",target:"_blank",rel:"noreferrer"},"https://www.ffmpeg.org/download.html")])],-1),s("p",null,[i("该网站中的FFMPEG分为3个版本：Static，Shared，Dev。 "),m(" more "),s("br"),i(" 前两个版本可以直接在命令行中使用，他们的区别在于 Static 里面只有3个应用程序：")],-1),s("ul",null,[s("li",null,"ffmpeg.exe"),s("li",null,"ffplay.exe"),s("li",null,"ffprobe.exe")],-1),s("p",null,"Shared里面除了3个应用程序：ffmpeg.exe，ffplay.exe，ffprobe.exe之外，还有一些Dll，比如说avcodec-54.dll之类的。",-1),s("p",null,"Shared里面的exe体积很小，他们在运行的时候，到相应的Dll中调用功能。",-1),s("p",null,"Dev版本是用于开发的，里面包含了库文件xxx.lib以及头文件xxx.h，这个版本不包含exe文件。",-1),s("p",null,"这里我们使用static版本，下载zip压缩文件，解压到指定目录，利用Windows自带命令提示符CMD，CD到解压的路径，",-1),s("p",null,"例如：D:\\ffmpeg201200216\\bin，这样bin下面的ffmpeg.exe就可以在命令行中使用了，可以用ffmpeg -version测试一下：",-1),s("p",null,"放一个mp4视频，然后把声音提取到output.acc，用命令测试一下：",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i movie.mp4 -acodec copy -vn output.aac")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"二、常用命令",tabindex:"-1"},[i("二、常用命令 "),s("a",{class:"header-anchor",href:"#二、常用命令","aria-label":'Permalink to "二、常用命令"'},"​")],-1),s("p",null,"主要参数：",-1),s("ul",null,[s("li",null,"-i 设定输入流"),s("li",null,"-f 设定输出格式"),s("li",null,"-ss 开始时间")],-1),s("p",null,"视频参数：",-1),s("ul",null,[s("li",null,"-b 设定视频流量(码率)，默认为200Kbit/s"),s("li",null,"-r 设定帧速率，默认为25"),s("li",null,"-s 设定画面的宽与高"),s("li",null,"-aspect 设定画面的比例"),s("li",null,"-vn 不处理视频"),s("li",null,"-vcodec 设定视频编解码器，未设定时则使用与输入流相同的编解码器")],-1),s("p",null,"音频参数：",-1),s("ul",null,[s("li",null,"-ar 设定采样率"),s("li",null,"-ac 设定声音的Channel数"),s("li",null,"-acodec 设定声音编解码器，未设定时则使用与输入流相同的编解码器"),s("li",null,"-an 不处理音频")],-1),s("h3",{id:"_1-视频格式转换",tabindex:"-1"},[i("1. 视频格式转换 "),s("a",{class:"header-anchor",href:"#_1-视频格式转换","aria-label":'Permalink to "1. 视频格式转换"'},"​")],-1),s("p",null,"比如一个avi文件，想转为mp4。",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i input.avi output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"_2-提取音频",tabindex:"-1"},[i("2. 提取音频 "),s("a",{class:"header-anchor",href:"#_2-提取音频","aria-label":'Permalink to "2. 提取音频"'},"​")],-1),s("p",null,"比如一个相声.MP4文件,只想听声音，提取音频为.ACC格式：",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i 相声.mp4 -acodec aac -vn output.aac")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"(-vn 不处理视频 )",-1),s("h3",{id:"_3-提取视频",tabindex:"-1"},[i("3. 提取视频 "),s("a",{class:"header-anchor",href:"#_3-提取视频","aria-label":'Permalink to "3. 提取视频"'},"​")],-1),s("p",null,"比如一个相声.MP4文件,只想看视频影像不听声音：",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i 相声.mp4 -vcodec copy -an output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"（-an 不处理音频）",-1),s("h3",{id:"_4-视频剪切",tabindex:"-1"},[i("4. 视频剪切 "),s("a",{class:"header-anchor",href:"#_4-视频剪切","aria-label":'Permalink to "4. 视频剪切"'},"​")],-1),s("p",null,"截取视频从时间为00:00:15开始，截取5秒钟的视频：",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -ss 00:00:15 -t 00:00:05 -i input.mp4 -vcodec copy -acodec copy output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"-ss表示开始切割的时间，-t表示要切多少。",-1),s("blockquote",null,[s("p",null,"ffmpeg 在切割视频的时候无法做到时间绝对准确，因为视频编码中关键帧（I帧）和跟随它的B帧、P帧是无法分割开的，否则就需要进行重新帧内编码，会让视频体积增大。所以，如果切割的位置刚好在两个关键帧中间，那么 ffmpeg 会向前/向后切割，所以最后切割出的 chunk 长度总是会大于等于应有的长度。")],-1),s("h3",{id:"_5-码率控制",tabindex:"-1"},[i("5.码率控制 "),s("a",{class:"header-anchor",href:"#_5-码率控制","aria-label":'Permalink to "5.码率控制"'},"​")],-1),s("p",null,[s("strong",null,"码率： bitrate = file size / duration")],-1),s("p",null,"比如一个文件20.8M，时长1分钟，那么，码率就是：",-1),s("p",null,[s("em",null,"biterate = 20.8M bit/60s = 20.8"),i("1024"),s("em",null,"1024"),i("8 bit/60s= 2831Kbps*")],-1),s("p",null,"ffmpg控制码率有3种选择:",-1),s("ul",null,[s("li",null,"-minrate"),s("li",null,"-b:v"),s("li",null,"-maxrate")],-1),s("p",null,"-b:v 主要是控制平均码率。 比如一个视频源的码率太高了，有10Mbps，文件太大，想把文件弄小一点，但是又不破坏分辨率:",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i input.mp4 -b:v 2000k -bufsize 2000k output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"-minrate -maxrate 设置码率波动阈值",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i input.mp4 -b:v 2000k -bufsize 2000k -maxrate 2500k output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"_6-视频编码格式转换",tabindex:"-1"},[i("6. 视频编码格式转换 "),s("a",{class:"header-anchor",href:"#_6-视频编码格式转换","aria-label":'Permalink to "6. 视频编码格式转换"'},"​")],-1),s("p",null,"相声.mp4的编码是MPEG4，转换H264编码：",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i input.mp4 -vcodec h264 output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"相反",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i input.mp4 -vcodec mpeg4 output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"_7-为视频添加logo",tabindex:"-1"},[i("7.为视频添加logo "),s("a",{class:"header-anchor",href:"#_7-为视频添加logo","aria-label":'Permalink to "7.为视频添加logo"'},"​")],-1),s("p",null,"水印logo.png贴到一个视频上，那可以用如下命令：",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i input.mp4 -i logo.png -filter_complex overlay output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h3",{id:"_8-旋转视频",tabindex:"-1"},[i("8. 旋转视频 "),s("a",{class:"header-anchor",href:"#_8-旋转视频","aria-label":'Permalink to "8. 旋转视频"'},"​")],-1),s("p",null,"在手机上录的视频，在电脑放，是颠倒的，需要旋转90度。",-1),s("div",{class:"language- max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i 相声.mp4 -vf transpose=1 rotate8.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"三、其他命令",tabindex:"-1"},[i("三、其他命令 "),s("a",{class:"header-anchor",href:"#三、其他命令","aria-label":'Permalink to "三、其他命令"'},"​")],-1),s("p",null,[i("官方文档："),s("a",{href:"https://www.ffmpeg.org/ffmpeg.html",target:"_blank",rel:"noreferrer"},"https://www.ffmpeg.org/ffmpeg.html")],-1),s("hr",null,null,-1),s("hr",null,null,-1),s("hr",null,null,-1),s("p",null,[s("a",{href:"https://blog.csdn.net/m0_37605642/article/details/121566820",target:"_blank",rel:"noreferrer"},"FFmpeg教程（超级详细版）")],-1),s("p",null,"ffmpeg是一款非常好用处理音视频的工具包。那什么是ffmpeg呢？FFmpeg是一套可以用来记录、转换数字音频、视频，并能将其转化为流的开源计算机程序，可以结合开发一些处理视频音频的功能。",-1),s("h2",{id:"_1-ffmpeg下载",tabindex:"-1"},[s("strong",null,"1.ffmpeg下载"),i(),s("a",{class:"header-anchor",href:"#_1-ffmpeg下载","aria-label":'Permalink to "**1.ffmpeg下载**"'},"​")],-1),s("p",null,[i("首先打开 "),s("a",{href:"https://link.segmentfault.com/?enc=Izolw4%2BjJMVj5SDMjqiKrw%3D%3D.Mto17U43p5v3DiIB07eqx9ppbLCst%2B4VFIH20eXjeY4yL6NJcpM5IVgk1EZ5cDb3YbYinyhbsUfXIMAslvKEGQ%3D%3D",target:"_blank",rel:"noreferrer"},"ffmpeg官网下载"),i(" 然后点击 windows 对应的图标，再点击下面的”Windows EXE Files”随便选一个点进去选择一个版本下载。")],-1),s("h2",{id:"_2-下载后解压-配置环境变量",tabindex:"-1"},[s("strong",null,"2.下载后解压，配置环境变量"),i(),s("a",{class:"header-anchor",href:"#_2-下载后解压-配置环境变量","aria-label":'Permalink to "**2.下载后解压，配置环境变量**"'},"​")],-1),s("p",null,"下载解压后就能在 bin 文件夹下能看到三个可执行程序：ffmpeg、ffplay、ffprobe，为bin文件夹配置好环境变量后即可使用。",-1),s("p",null,[i("验证是否成功： cmd窗口输入 "),s("code",null,"ffmpeg -version"),i(" 验证是否安装成功。")],-1),s("h2",{id:"_3-关键指令",tabindex:"-1"},[s("strong",null,"3.关键指令"),i(),s("a",{class:"header-anchor",href:"#_3-关键指令","aria-label":'Permalink to "**3.关键指令**"'},"​")],-1),s("p",null,"一.查看FFmpeg支持的编码器",-1),s("div",{class:"language-ebnf max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"ebnf"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg configure -encoders")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"二.查看FFmpeg支持的解码器",-1),s("div",{class:"language-ebnf max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"ebnf"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg configure -decoders")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"三.查看FFmpeg支持的通信协议",-1),s("div",{class:"language-ebnf max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"ebnf"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg configure -protocols")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"四.查看FFmpeg所支持的音视频编码格式、文件封装格式与流媒体传输协议",-1),s("div",{class:"language-ada max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"ada"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg configure "),s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"--help")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,[i("五.播放视频 "),s("a",{href:"https://link.segmentfault.com/?enc=MbRHi7LQKjNQ9cBKCUyXFw%3D%3D.HFbVidqg8FuLbNzY6ZOf7XGzGGSd21yQoXugZEkmI5U17yYSkXAm%2BM%2Bio8hYxrqc",target:"_blank",rel:"noreferrer"},"FFmpeg命令行工具学习(二)：播放媒体文件的工具ffplay")],-1),s("div",{class:"language-graphql max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"graphql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ffplay"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," input"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".mp4")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# 播放完自动退出")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ffplay"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"autoexit"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," input"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"六.设置视频的屏幕高宽比",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"input"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -aspect "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9"),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}}," output"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"通常使用的宽高比是：")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"9")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"16"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"21"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"35"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"39"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"七.编码格式转换 MPEG4编码转成H264编码",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"input"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -strict "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -vcodec h264 "),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"output"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"H264编码转成MPEG4编码",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"input"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -strict "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -vcodec mpeg4 "),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}},"output"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"_4-视频压缩",tabindex:"-1"},[s("strong",null,"4.视频压缩"),i(),s("a",{class:"header-anchor",href:"#_4-视频压缩","aria-label":'Permalink to "**4.视频压缩**"'},"​")],-1),s("div",{class:"language-apache max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"apache"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2020"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".mp4 -vcodec h264 -vf scale="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"640"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":-"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -threads "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 2020_conv.mp4")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1579251906"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".mp4 -strict -"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -vcodec h264 1579251906_output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"参数解释:",-1),s("div",{class:"language-diff max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"diff"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-i 2020.mp4")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"输入文件，源文件")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"2020_conv.mp4")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"输出文件，目标文件")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-vf scale=640:-2  ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"改变视频分辨率，缩放到640px宽，高度的-2是考虑到libx264要求高度是偶数，所以设置成-2,让软件自动计算得出一个接近等比例的偶数高")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-threads 4")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"4核运算")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"其他参数：",-1),s("div",{class:"language-diff max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"diff"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-s 1280x720 ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"设置输出文件的分辨率，w*h。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-b:v ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"输出文件的码率，一般500k左右即可，人眼看不到明显的闪烁，这个是与视频大小最直接相关的。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-preset")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"指定输出的视频质量，会影响文件的生成速度，有以下几个可用的值 ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"与 veryslow相比，placebo以极高的编码时间为代价，只换取了大概1%的视频质量提升。这是一种收益递减准则：slow 与 medium相比提升了5%~10%；slower 与 slow相比提升了5%；veryslow 与 slower相比提升了3%。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"针对特定类型的源内容（比如电影、动画等），还可以使用-tune参数进行特别的优化。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-an")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"去除音频流。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-vn")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"去除视频流。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-c:a")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"指定音频编码器。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-c:v")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"指定视频编码器，libx264，libx265，H.262，H.264，H.265。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"libx264：最流行的开源 H.264 编码器。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"NVENC：基于 NVIDIA GPU 的 H.264 编码器。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"libx265：开源的 HEVC 编码器。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"libvpx：谷歌的 VP8 和 VP9 编码器。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"libaom：AV1 编码器。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-vcodec copy")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"表示不重新编码，在格式未改变的情况采用。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-re ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"以源文件固有帧率发送数据。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-minrate 964K -maxrate 3856K -bufsize 2000K ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"指定码率最小为964K，最大为3856K，缓冲区大小为 2000K。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-y")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"不经过确认，输出时直接覆盖同名文件。")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#B31D28","--shiki-dark":"#FDAEB7"}},"-crf")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参数来控制转码，取值范围为 0~51，其中0为无损模式，18~28是一个合理的范围，数值越大，画质越差。")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"_5-视频拼接",tabindex:"-1"},[s("strong",null,"5.视频拼接"),i(),s("a",{class:"header-anchor",href:"#_5-视频拼接","aria-label":'Permalink to "**5.视频拼接**"'},"​")],-1),s("p",null,"一.将4个视频拼接成一个很长的视频（无声音）",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"3"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -filter_complex "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'[0:0][1:0] [2:0][3:0] concat=n=4:v=1 [v]'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -map "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'[v]'"),s("span",{style:{"--shiki-light":"#22863A","--shiki-dark":"#85E89D"}}," output"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"二.将4个视频拼接成一个很长的视频（有声音）",-1),s("div",{class:"language-inform7 max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"inform7"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i 1.mp4 -i 2.mp4 -i 3.mp4 -filter_complex '[0:0][0:1] [1:0][1:1] [2:0][2:1] concat=n=3:v=1:a=1 [v][a]' -map '[v]' -map '[a]’  output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"参数解释：",-1),s("div",{class:"language-inform7 max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"inform7"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"[0:0][0:1] [1:0][1:1] [2:0][2:1] ")]),i(`
`),s("span",{class:"line"},[s("span",null,"分别表示第1个输入文件的视频、音频，第2个输入文件的视频、音频，第3个输入文件的视频、音频。")]),i(`
`),s("span",{class:"line"},[s("span")]),i(`
`),s("span",{class:"line"},[s("span",null,"concat=n=3:v=1:a=1 ")]),i(`
`),s("span",{class:"line"},[s("span",null,"表示有3个输入文件，输出一条视频流和一条音频流。")]),i(`
`),s("span",{class:"line"},[s("span")]),i(`
`),s("span",{class:"line"},[s("span",null,"[v][a] ")]),i(`
`),s("span",{class:"line"},[s("span",null,"得到的视频流和音频流的名字，注意在 bash 等 shell 中需要用引号，防止通配符扩展。")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"三.横向拼接2个视频",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -filter_complex "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"[0:v]pad=iw*2:ih*1[a];[a][1:v]overlay=w"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"参数解释",-1),s("div",{class:"language-routeros max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"routeros"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"pad")]),i(`
`),s("span",{class:"line"},[s("span",null,"将合成的视频宽高，这里iw代表第1个视频的宽，iw*2代表合成后的视频宽度加倍，ih为第1个视频的高，合成的两个视频最好分辨率一致。")]),i(`
`),s("span",{class:"line"},[s("span")]),i(`
`),s("span",{class:"line"},[s("span",null,"overlay")]),i(`
`),s("span",{class:"line"},[s("span",null,"覆盖，[a][1:v]overlay=w，后面代表是覆盖位置w:0。")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"四.竖向拼接2个视频",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -filter_complex "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"[0:v]pad=iw:ih*2[a];[a][1:v]overlay=0:h"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out_2"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"五.横向拼接3个视频",-1),s("div",{class:"language-inform7 max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"inform7"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,'ffmpeg -i 0.mp4 -i 1.mp4 -i 2.mp4 -filter_complex "[0:v]pad=iw*3:ih*1[a];[a][1:v]overlay=w[b];[b][2:v]overlay=2.0*w" out_v3.mp4')])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"六.竖向拼接3个视频",-1),s("div",{class:"language-inform7 max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"inform7"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,'ffmpeg -i 0.mp4 -i 1.mp4 -i 2.mp4 -filter_complex "[0:v]pad=iw:ih*3[a];[a][1:v]overlay=0:h[b];[b][2:v]overlay=0:2.0*h" out_v4.mp4')])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"七.4个视频2x2方式排列",-1),s("div",{class:"language-inform7 max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"inform7"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,'ffmpeg -i 0.mp4 -i 1.mp4 -i 2.mp4 -i 3.mp4 -filter_complex "[0:v]pad=iw*2:ih*2[a];[a][1:v]overlay=w[b];[b][2:v]overlay=0:h[c];[c][3:v]overlay=w:h" out.mp4')])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"_6-视频帧操作",tabindex:"-1"},[s("strong",null,"6.视频帧操作"),i(),s("a",{class:"header-anchor",href:"#_6-视频帧操作","aria-label":'Permalink to "**6.视频帧操作**"'},"​")],-1),s("p",null,[s("a",{href:"https://link.segmentfault.com/?enc=Sb1JvoyOfFuBGmRsBDo7%2BQ%3D%3D.6Hpu2r%2BOci0ASqjs6dAWnLDhrkEYDXTTBqcnda8wjKTLM9fJ9Zb5%2B1%2FnDMifPKrv",target:"_blank",rel:"noreferrer"},"ffmpeg和H264视频的编解码")],-1),s("p",null,"一.查看每帧的信息",-1),s("div",{class:"language-nginx max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"nginx"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"ffprobe"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -v "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"error"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -show_frames gemfield.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"从pict_type=I可以看出这是个关键帧，然后key_frame=1 表示这是IDR frame，如果key_frame=0表示这是Non-IDR frame。",-1),s("p",null,"二.截取视频中的某一帧 把gemfield.mp4视频的第1分05秒的一帧图像截取出来。",-1),s("div",{class:"language-apache max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"apache"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# input seeking")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -ss "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"05"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i gemfield.mp4 -frames:v "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out.jpg")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# output seeking")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i gemfield.mp4 -ss "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"00"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"05"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -frames:v "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out1.jpg")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"参数解释：",-1),s("div",{class:"language-sas max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"sas"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"frame:v "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"，在video stream上截取1帧。")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input seeking使用的是key frames，所以速度很快；而output seeking是逐帧decode，直到1分05秒，所以速度很慢。")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"重要说明：",-1),s("div",{class:"language-pgsql max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"pgsql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg截取视频帧有2种 seeking 方式，对应有2种 coding 模式：transcoding 和 stream copying（ffmpeg -c copy）。")]),i(`
`),s("span",{class:"line"},[s("span")]),i(`
`),s("span",{class:"line"},[s("span",null,"transcoding 模式：需要 decoding + encoding 的模式，即先 decoding 再encoding。")]),i(`
`),s("span",{class:"line"},[s("span")]),i(`
`),s("span",{class:"line"},[s("span",null,"stream copying 模式：不需要decoding + encoding的模式，由命令行选项-codec加上参数copy来指定（-c:v copy ）。在这种模式下，ffmpeg在video stream上就会忽略 decoding 和 encoding步骤。")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"三.查看视频总帧数",-1),s("div",{class:"language-routeros max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"routeros"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffprobe -v error -count_frames -select_streams v:0 -show_entries stream=nb_frames -of default=nokey=1:noprint_wrappers=1 gemfield.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"四.查看 key frame 帧数",-1),s("div",{class:"language-routeros max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"routeros"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffprobe -v error -count_frames -select_streams v:0 -show_entries stream=nb_read_frames -of default=nokey=1:noprint_wrappers=1 -skip_frame nokey gemfield.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"五.查看 key frame 所在的时间",-1),s("div",{class:"language-routeros max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"routeros"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffprobe -v error -skip_frame nokey -select_streams v:0 -show_entries frame=pkt_pts_time -of csv=print_section=0 gemfield.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"六.查看 key frame 分布的情况",-1),s("div",{class:"language-elm max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"elm"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ffprobe"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"v error "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"show_frames gemfield"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mp4"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," grep pict_type")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"七.查看 key frame 所在的帧数",-1),s("div",{class:"language-routeros max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"routeros"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffprobe -v error -select_streams v -show_frames -show_entries frame=pict_type -of csv gemfield.mp4 | grep -n I | cut -d ':' -f 1")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"八.重新设置 key frame interval",-1),s("div",{class:"language-oxygene max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"oxygene"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffmpeg -i gemfield.mp4 -vcodec libx264 -x264-params keyint=1:scenecut=0 -acodec copy out.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"九.查看视频波特率",-1),s("div",{class:"language-routeros max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"routeros"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"ffprobe -v error -select_streams v:0 -show_entries stream=bit_rate -of default=noprint_wrappers=1:nokey=1 gemfield.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"_7-图片与视频",tabindex:"-1"},[s("strong",null,"7.图片与视频"),i(),s("a",{class:"header-anchor",href:"#_7-图片与视频","aria-label":'Permalink to "**7.图片与视频**"'},"​")],-1),s("p",null,"7.1 图片转视频（规则的名称）",-1),s("div",{class:"language-apache max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"apache"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -f image2 -i 'in%6d.jpg' -vcodec libx264 -r "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"25"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -b 200k test.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"参数解释：",-1),s("div",{class:"language-armasm max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"armasm"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",null,"-r 25 表示每秒播放25帧")]),i(`
`),s("span",{class:"line"},[s("span",null,"-b 200k 指定码率为200k")]),i(`
`),s("span",{class:"line"},[s("span",null,"    ")]),i(`
`),s("span",{class:"line"},[s("span",null,'图片的文件名为"in000000.jpg"，从0开始依次递增。')])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"7.2 图片转视频（不规则的名称） 不规则图片名称转视频。 7.2.1 方法一 不规则图片名称合成视频文件。",-1),s("div",{class:"language-stata max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stata"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"framerate "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"pattern_type glob "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i '"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".jpg' "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"out"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".mp4")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"cat"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," *"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".png "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"|"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ffmpeg "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"f image2pipe "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," output.mp4")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"参数解释：")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"framerate "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"10"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"：视频帧率")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"pattern_type glob：Glob pattern 模糊匹配")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"f image2pipe：图像管道，模糊匹配得到图片名称")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"7.2.2 方法二 不规则图片名称合成视频文件。 一.先动手把不规则文件重命名规则图片名。",-1),s("div",{class:"language-vim max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"vim"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"def"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getTpyeFile"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(filelist, type):     ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    res "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," []     ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," item "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," filelist:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"         name, suf "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," os.path.splitext"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"item"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 文件名，后缀")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"         if"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," suf "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," type:")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"             res.append"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"item"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"     return"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," res")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"pwd "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," os.getcwd"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 返回当前目录的绝对路径")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"dirs "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," os.listdir"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"() "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," 当前目录下所有的文件名组成的数组")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"typefiles "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," getTpyeFile"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(dirs, "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'.jpg'"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"for"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," i "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," range"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},","),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"len"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"typefiles"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")):")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"     os.rename"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(typefiles[i],"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"./%d.jpg"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," % ("),s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"i"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")) "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"将文件以数字规则命令")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"二.将需要合成的图片放在txt中，通过读取txt文件合并成视频。",-1),s("div",{class:"language-lua max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"lua"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"f concat "),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"i files."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"txt"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," output."),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,[i("7.3 图片格式转换 "),s("a",{href:"https://link.segmentfault.com/?enc=5bIZXMoulTEaCeqgg4zpbQ%3D%3D.DUnnx1L7rD2OhkOFdMiQVShs3E1EAl%2BPS7gcKRfAdErCx4%2FQiQCZ0dJ7z4h%2F9KwsujLbgabastPrMq%2BwDweKUQ%3D%3D",target:"_blank",rel:"noreferrer"},"ffmpeg图片格式转换")],-1),s("p",null,"webp转换成jpg",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".webp"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".jpg")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"webp转换成png",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".webp"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".png")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"jpg转换成png",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".jpg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".png")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"jpg转换成webp",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".jpg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".webp")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"png转换成webp",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".png"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".webp")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,"png转换成jpg",-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".png"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," out"),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},".jpg")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("h2",{id:"_8、硬解码与软解码",tabindex:"-1"},[s("strong",null,"8、硬解码与软解码"),i(),s("a",{class:"header-anchor",href:"#_8、硬解码与软解码","aria-label":'Permalink to "**8、硬解码与软解码**"'},"​")],-1),s("p",null,"一.CPU富余、需要精准控制解码流程、有解码算法的优化、通用性要求高，直接使用软解（也就是CPU解码）; 二.有其他编解码芯片/模组、CPU不够用，就不得不需要转向硬解码（也就是专用芯片解码）。",-1),s("p",null,[i("2022-09-13 新增 "),s("a",{href:"https://link.segmentfault.com/?enc=0PTchLkkUS0WiWqtOetXrQ%3D%3D.cuZbtzsgZAOTe42F1vmtKuoCDXuI74FEG0DZtUhFM3f9JndRKpdeUlHd%2FJhPDhBpxhYtREUmbPFiLk0Oa4zFlw%3D%3D",target:"_blank",rel:"noreferrer"},"ffmpeg命令目录")],-1),s("p",null,[s("strong",null,"调整视频分辨率-s")],-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"、用-s参数设置视频分辨率，参数值wxh，w宽度单位是像素，h高度单位是像素")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ffmpeg -i input_file -s "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"320"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"x240 output_file")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"、预定义的视频尺寸")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    下面两条命令有相同效果")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.avi -s "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"640"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"x480 output.avi")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.avi -s vga output.avi")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,[s("strong",null,"Scale filter调整分辨率")],-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Scale filter的优点是可以使用一些额外的参数")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"    Scale"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"width"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"height["),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"interl"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"|"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-1"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"下面两条命令有相同效果")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.mpg -s "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"320"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"x240 output.mp4 ")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.mpg -vf scale"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"320"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"240"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," output.mp4")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"对输入视频成比例缩放")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"改变为源视频一半大小")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.mpg -vf scale"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iw"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ih"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"2"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," output.mp4")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"改变为原视频的90"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"%"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"大小：")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.mpg -vf scale"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"iw"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0.9"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ih"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0.9"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," output.mp4")])])]),s("button",{class:"code-block-unfold-btn"})],-1),s("p",null,[s("strong",null,"在未知视频的分辨率时，保证调整的分辨率与源视频有相同的横纵比。"),i(" 可能会有错误，不推荐使用，最好传入明确的缩放值 另外，scale只能接受偶数，否则height not divisible by 2")],-1),s("div",{class:"language-stylus max-h-400px"},[s("button",{title:"Copy code",class:"copy"}),s("span",{class:"lang"},"stylus"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[s("code",{"v-pre":""},[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"宽度固定400，高度成比例：")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.avi -vf scale"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"400"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-2")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"相反地，高度固定300，宽度成比例：")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"    ffmpeg"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," -i input.avi -vf scale"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-2"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"300")])])]),s("button",{class:"code-block-unfold-btn"})],-1)])]),"main-header":l(()=>[t(a.$slots,"main-header")]),"main-header-after":l(()=>[t(a.$slots,"main-header-after")]),"main-nav":l(()=>[t(a.$slots,"main-nav")]),"main-content-before":l(()=>[t(a.$slots,"main-content-before")]),"main-content":l(()=>[t(a.$slots,"main-content")]),"main-content-after":l(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":l(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":l(()=>[t(a.$slots,"main-nav-after")]),comment:l(()=>[t(a.$slots,"comment")]),footer:l(()=>[t(a.$slots,"footer")]),aside:l(()=>[t(a.$slots,"aside")]),"aside-custom":l(()=>[t(a.$slots,"aside-custom")]),default:l(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter"])}}};export{U as default,v as usePageData};
